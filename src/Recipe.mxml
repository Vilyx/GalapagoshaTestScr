<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark"
		 xmlns:mx="library://ns.adobe.com/flex/mx"
		 xmlns:ns1="*"
		 width="1080" height="1920" currentState="recipe_start"
		 textAlign.recipe_print="center" stateChangeComplete="group1_stateChangeCompleteHandler(event)" addedToStage="group1_addedToStageHandler(event)">
	<fx:Style source="styles.css"/>
	<fx:Script>
		<![CDATA[
			import avmplus.getQualifiedClassName;
			
			import mx.events.FlexEvent;
			
			private var timer:Timer = new Timer(18000);
			[Embed(source='../assets/recipe_complete.mp3')] 		 
			private var MySound : Class; 
			
			private var currentRecipe:String;
			protected function group1_stateChangeCompleteHandler(event:FlexEvent):void
			{
				switch(currentState)
				{
					case "recipe_shake":
					case "recipe_cream":
					case "recipe_blin":
					case "recipe_zhar":
						timer.reset();
						timer.start();
						RecursiveStop(swfPlayer.content as MovieClip);
						currentRecipe = recipeChooser.currentState = this.currentState;
						break;
					default:
						timer.reset();
				}
				
			}
			private function RecursiveStop(mc:MovieClip):void
			{
				if(mc == null) {trace("null");return;}
				for(var i:int = 0; i < mc.numChildren; i++)
				{
					var obj:Object = mc.getChildAt(i);
					
					trace(obj); // debugging
					
					if(mc.getChildAt(i) is MovieClip || getQualifiedSuperclassName(obj) == "flash.display::MovieClip")
					{
						RecursiveStop(obj as MovieClip);
					}
				}
				var transform:SoundTransform = new SoundTransform(0);
				mc.soundTransform = transform;
				//mc.stop();
			}
			protected function recipeiconshake1_clickHandler(event:MouseEvent):void
			{
				RecursiveStop(swfPlayer.content as MovieClip);
				currentRecipe = currentState = "recipe_shake";
			}
			
			protected function recipeiconblin1_clickHandler(event:MouseEvent):void
			{
				RecursiveStop(swfPlayer.content as MovieClip);
				currentRecipe = currentState = "recipe_blin";
			}
			
			protected function recipeiconcream1_clickHandler(event:MouseEvent):void
			{
				RecursiveStop(swfPlayer.content as MovieClip);
				currentRecipe = currentState = "recipe_cream";
			}
			
			protected function recipeiconzhar1_clickHandler(event:MouseEvent):void
			{
				RecursiveStop(swfPlayer.content as MovieClip);
				currentRecipe = currentState = "recipe_zhar";
			}
			
			protected function recipeChooser_stateChangeCompleteHandler(event:FlexEvent):void
			{
				currentState = event.target.currentState;
			}
			
			protected function group1_addedToStageHandler(event:Event):void
			{
				timer.removeEventListener(TimerEvent.TIMER,onTimer);
				timer.addEventListener(TimerEvent.TIMER,onTimer);
				timer.reset();
				currentState = "recipe_start";
				currentRecipe = null;
			}
			
			protected function printGroup_clickHandler(event:MouseEvent):void
			{
				switch(currentRecipe)
				{
					case "recipe_shake":
						trace("Шейк");
						break;
					case "recipe_cream":
						trace("Мороженка");
						break;
					case "recipe_blin":
						trace("Блины");
						break;
					case "recipe_zhar":
						trace("Жареный банан");
						break;
				}
				timer.removeEventListener(TimerEvent.TIMER,onTimer);
				timer.addEventListener(TimerEvent.TIMER,onTimer);
				timer.reset();
				currentState = "recipe_start";
				currentRecipe = null;
			}
			
			protected function onTimer(event:TimerEvent):void
			{
				(new MySound() as Sound).play();
				currentState = "recipe_print";
			}
			
		]]>
	</fx:Script>
	<s:states>
		<s:State name="recipe_start"/>
		<s:State name="recipe_shake"/>
		<s:State name="recipe_cream"/>
		<s:State name="recipe_blin"/>
		<s:State name="recipe_zhar"/>
		<s:State name="recipe_print"/>
		<s:State name="recipe_next"/>
	</s:states>
	<fx:Declarations>
		<!-- Place non-visual elements (e.g., services, value objects) here -->
	</fx:Declarations>
	
	
	
	<s:Image x="0" y="0" source="@Embed('../assets/Recipe/bg.jpg')"
			 x.recipe_start="0" y.recipe_start="0"/>
	<s:SWFLoader id="swfPlayer" excludeFrom="recipe_print,recipe_next" alpha.recipe_start="0" y="900" width="472" height="268" horizontalCenter="230"
				 source.recipe_cream="@Embed('../assets/iceCream.swf')" source.recipe_shake="@Embed('../assets/shakeRecipe.swf')" source.recipe_blin="@Embed('../assets/pancakes.swf')" source.recipe_zhar="@Embed('../assets/friedRecipe.swf')"/>
	<s:Group left="0" top="0"  width="1080" bottom="0" includeIn="recipe_start">	
		<s:TextArea includeIn="recipe_start" y="451" height="319" borderVisible="false"
					color="#FFFFFF" contentBackgroundAlpha="0.0" editable="false"
					horizontalCenter="0" mouseEnabled="false" selectable="false"
					styleName="metrHeader" text="Бананы&#xd;каждый день"/>
		<s:Group y="780" left="0" right="0" height="200" click="recipeiconshake1_clickHandler(event)">
			<s:TextArea includeIn="recipe_start" x="703" y="63" width="341" height="165"
						borderVisible="false" contentBackgroundAlpha="0.0" editable="false"
						mouseEnabled="false" selectable="false" styleName="recipeDescr"
						text="Банановый&#xd;шейк"/>
			<s:TextArea includeIn="recipe_start" x="179" y="63" width="246" height="146"
						borderVisible="false" contentBackgroundAlpha="0.0" editable="false"
						mouseEnabled="false" selectable="false" styleName="recipeName" text="Для&#xd;тонуса"/>
			<ns1:RecipeIconShake includeIn="recipe_start" x="493.55" y="26"
								 />
		</s:Group>
		<s:Group y="1016" left="0" right="0" height="210" click="recipeiconblin1_clickHandler(event)">
			<s:TextArea includeIn="recipe_start" x="701" y="41" width="325" height="146"
						borderVisible="false" contentBackgroundAlpha="0.0" editable="false"
						mouseEnabled="false" selectable="false" styleName="recipeDescr"
						text="Банановые&#xd;блинчики"/>
			<s:TextArea includeIn="recipe_start" x="119" y="41" width="304" height="146"
						borderVisible="false" contentBackgroundAlpha="0.0" editable="false"
						mouseEnabled="false" selectable="false" styleName="recipeName"
						text="Для&#xd;завтрака"/>
			<ns1:RecipeIconBlin includeIn="recipe_start" x="485" y="45"
								/>
		</s:Group>
		<s:Group y="1238" left="0" right="0" height="200" click="recipeiconcream1_clickHandler(event)">
			<s:TextArea x="699" y="30" width="325" height="150" borderVisible="false"
						contentBackgroundAlpha="0.0" editable="false" mouseEnabled="false"
						selectable="false" styleName="recipeDescr" text="Банановое&#xd;мороженое"/>
			<s:TextArea x="99" y="30" width="324" height="146" borderVisible="false"
						contentBackgroundAlpha="0.0" editable="false" mouseEnabled="false"
						selectable="false" styleName="recipeName" text="Для&#xd;вечеринки"/>
			<ns1:RecipeIconCream x="512.95" y="-16" height="191.55"
								 />
		</s:Group>
		<s:Group y="1472" left="0" right="0" height="206" click="recipeiconzhar1_clickHandler(event)">
			<s:TextArea includeIn="recipe_start" x="693" y="35" width="325" height="148"
						borderVisible="false" contentBackgroundAlpha="0.0" editable="false"
						mouseEnabled="false" selectable="false" styleName="recipeDescr"
						text="Жареные&#xd;бананы"/>
			<s:TextArea includeIn="recipe_start" x="63" y="27" width="354" height="146"
						borderVisible="false" contentBackgroundAlpha="0.0" editable="false"
						mouseEnabled="false" selectable="false" styleName="recipeName"
						text="Всем&#xd;на радость"/>
			<ns1:RecipeIconZhar includeIn="recipe_start" x="477.3" y="27"
								/>
		</s:Group>
	</s:Group>
	
	
	
	<s:TextArea selectable="false" mouseEnabled="false" borderVisible="false" contentBackgroundAlpha="0.0" editable="false" includeIn="recipe_blin,recipe_cream,recipe_shake,recipe_zhar" x="12" y="551"
			 width="1044" color="#FFFFFF" styleName="metrHeader"
			 text="Банановый&#xd;шейк"
			 text.recipe_blin="Банановые&#xd;блинчики"
			 text.recipe_cream="Банановое&#xd;мороженное"
			 text.recipe_zhar="Жареные&#xd;бананы"/>
	<s:TextArea selectable="false" mouseEnabled="false" borderVisible="false" contentBackgroundAlpha="0.0" editable="false" includeIn="recipe_next,recipe_print" horizontalCenter="0" y="466" styleName="metrText" text="Поэтому в Эквадоре&#xd;самые вкусные&#xd;и полезные бананы&#xd;на свете"/>
	<s:TextArea includeIn="recipe_next" x="18" y="985" width="1044" borderVisible="false"
				color="#FFFFFF" contentBackgroundAlpha="0.0" editable="false" mouseEnabled="false"
				selectable="false" styleName="metrHeader" text="Приятного&#xd;аппетита!"/>
	<s:TextArea selectable="false" mouseEnabled="false" borderVisible="false" contentBackgroundAlpha="0.0" editable="false" includeIn="recipe_next" horizontalCenter="0" y="1285" color="#FFFFFF"
			 fontFamily="BananaFontItal" fontSize="50" lineHeight="90%"
			 text="Выбирай следующий&#xd;рецепт:" textAlign="center"/>
	
	<s:Image top="80" width="554" height="414" horizontalCenter="0"
			 source="@Embed('../assets/olushaUpper.png')"/>
	<ns1:RecipeChooser id="recipeChooser" excludeFrom="recipe_start" y="1408" left="0" right="0" height="300" stateChangeComplete="recipeChooser_stateChangeCompleteHandler(event)"/>
	
	<s:Group id="printGroup" includeIn="recipe_print" x="111" y="820" width="820" height="544" click="printGroup_clickHandler(event)">
		<s:TextArea includeIn="recipe_print" x="52" y="333" borderVisible="false" color="#FFFFFF"
					contentBackgroundAlpha="0.0" editable="false" fontFamily="BananaFontBloldItal"
					fontSize="50" lineHeight="90%" mouseEnabled="false" selectable="false"
					text="Распечатай&#xd;рецепт &#xd;и приготовь&#xd;дома!"/>
		<ns1:TouchItBlinking3 includeIn="recipe_print" x="246" y="38"/>
	</s:Group>
	
</s:Group>
